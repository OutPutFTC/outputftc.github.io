workflow_dispatch:

jobs:
build-and-commit:
runs-on: ubuntu-latest

steps:
  # Etapa 1: Baixar o codigo do repositorio
  - name: Checkout do Codigo
    uses: actions/checkout@v4
    with:
      # Necessario para que o git-auto-commit-action@v5 possa criar e enviar um novo commit
      fetch-depth: 0 
      
  # Etapa 2: Configurar o ambiente Node.js (necessario para npm/react)
  - name: Configurar Node.js
    uses: actions/setup-node@v4
    with:
      node-version: '20' # Versao LTS recomendada para React

  # Etapa 3: Instalar dependencias e executar o comando de build do React
  - name: Instalar Dependencias e Fazer Build
    run: |
      npm install --force # Instala dependencias
      npm run build       # Executa o build (cria a pasta 'build/')

  # Etapa 4: Commit Automatico dos arquivos gerados (pasta 'build/')
  # Nota: Certifique-se de que a pasta 'build' NAO esta no seu .gitignore.
  - name: Adicionar e Comitar Arquivos de Build
    uses: stefanzweifel/git-auto-commit-action@v5
    with:
      # Define a mensagem de commit
      commit_message: "chore: Automatic build of React assets [skip ci]"
      # O [skip ci] eh crucial para evitar que este commit dispare outro workflow, prevenindo um loop.
      # Define quais arquivos/pastas serao comitados. 
      # Por padrao, projetos React geram a pasta 'build'
      files: build/
