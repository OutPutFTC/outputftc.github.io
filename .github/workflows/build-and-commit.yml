name: Build e Commit Automático (React)

on:
  push:
    branches:
      - main # Mude para 'master' se for o nome da sua branch principal
  workflow_dispatch:

jobs:
  build-and-commit:
    # O ambiente onde a tarefa será executada (máquina virtual Linux)
    runs-on: ubuntu-latest

    # Os passos sequenciais dentro do job
    steps:
      # Etapa 1: Baixar o código do repositório
      - name: Checkout do Código
        uses: actions/checkout@v4
        with:
          # Necessário para permitir que a próxima etapa faça um commit de volta
          fetch-depth: 0

      # Etapa 2: Configurar o ambiente Node.js
      - name: Configurar Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20' # Versão LTS (Long-Term Support)

      # Etapa 3: Instalar dependências e executar o comando de build
      - name: Instalar Dependências e Fazer Build
        run: |
          npm install --force # Instala dependências
          npm run build       # Executa o build (gera a pasta 'build/')

      # Etapa 4: Commit Automático dos arquivos gerados
      - name: Adicionar e Comitar Arquivos de Build
        uses: stefanzweifel/git-auto-commit-action@v5
        with:
          # Mensagem de commit. [skip ci] evita loop infinito de builds
          commit_message: "chore: Automatic build of React assets [skip ci]"
          # Especifica a pasta a ser comitada (geralmente 'build/' no React)
          files: build/
